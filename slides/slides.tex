% ----------------------------------------------------------------------------------------------------------------------------------
% High Performance pgBackRest
%
% Build from the Vagrant VM:
% cd /talk/slides && make -f /template/Makefile
% ----------------------------------------------------------------------------------------------------------------------------------
\def\mytitle{pgAudit Overview}
\def\mysubject{}
\def\myevent{Crunchy Storm}
\def\myauthor{David Steele}
\def\myemail{}
\def\mydate{November 28, 2018}

% Suppres navigation bars
\def\mysuppressnav{}

% Include Crunchy template
\def\mytemplatepath{/template/}
\input{\mytemplatepath crunchy-template.tex}

\begin{frame}
    \frametitle{About David}

    \begin{itemize}
        \item Principal Architect at Crunchy Data, the Trusted Open Source Enterprise PostgreSQL Leader.
        \item Actively developing with PostgreSQL since 1999.
        \item PostgreSQL Contributor.
        \item Primary author of pgBackRest and co-author of pgAudit.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Why pgAudit?}

    \begin{itemize}
        \item The goal of the PostgreSQL Audit extension (pgAudit) is to provide PostgreSQL users with capability to produce audit logs often required to comply with government, financial, or ISO certifications.
        \item Organizations may also have internal requirements that can be satisfied with pgAudit.
        \item Can also be used for detailed debugging, metrics, and monitoring.
    \end{itemize}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Example (log\_statement = all)}

    \begin{itemize}
        \item User statement:

    \vspace{.75em}\begin{lstlisting}
DO $$
BEGIN
    EXECUTE 'CREATE TABLE import' || 'ant_table (id INT)';
END $$;
    \end{lstlisting}\pause\vspace{1em}

        \item What gets logged:

    \vspace{.75em}\begin{lstlisting}
LOG:  statement: DO $$
BEGIN
    EXECUTE 'CREATE TABLE import' || 'ant_table (id INT)';
END $$;â€¨
    \end{lstlisting}\pause\vspace{1em}

    \end{itemize}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Example (pgAudit)}

    \begin{itemize}
        \item User statement:

    \vspace{.75em}\begin{lstlisting}
DO $$
BEGIN
    EXECUTE 'CREATE TABLE import' || 'ant_table (id INT)';
END $$;
    \end{lstlisting}\pause\vspace{1em}

        \item What gets logged:

    \vspace{.75em}\begin{lstlisting}
AUDIT: SESSION,33,1,FUNCTION,DO,,,"DO $$
BEGIN
    EXECUTE 'CREATE TABLE import' || 'ant_table (id INT)';
END $$;"
AUDIT: SESSION,33,2,DDL,CREATE TABLE,TABLE,public.important_table,CREATE TABLE important_table (id INT)
    \end{lstlisting}\pause\vspace{1em}

    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Stability}

    \begin{itemize}
        \item Stability is one of the primary goals of pgAudit.
        \item Each release is maintained on a separate branch like PostgreSQL (e.g. REL\_11\_STABLE).
        \item Only bug fixes are back-patched.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{The Future}

    \begin{itemize}
        \item Add new logging class MISC\_SET.
        \item Add user settable comment field.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Questions?}

    website: \url{http://www.pgaudit.org}\\
    \vspace{1em}
    email: \href{mailto:david@crunchydata.com}{david@crunchydata.com}\\
    \vspace{1em}
    source: \url{https://github.com/pgaudit/pgaudit}
\end{frame}

% End document
\end{document}
